# Settings Page Structure

## Visual Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Header (with back to dashboard link)                       â”‚
â”‚  Settings                                                    â”‚
â”‚  Manage your account settings and preferences               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¤ Account                                                  â”‚
â”‚  Manage your account information and profile                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Email: user@example.com                                    â”‚
â”‚  Full Name: John Doe                                        â”‚
â”‚  Role: Admin                                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
â”‚  [Edit Profile]                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”’ Change Password                                          â”‚
â”‚  Update your password to keep your account secure           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  New Password                                               â”‚
â”‚  [_______________________________________________]           â”‚
â”‚                                                              â”‚
â”‚  Confirm Password                                           â”‚
â”‚  [_______________________________________________]           â”‚
â”‚                                                              â”‚
â”‚  [Change Password]                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”” Notifications                                            â”‚
â”‚  Control what notifications you receive                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Reactions                                       [Toggle ON] â”‚
â”‚  Get notified when someone likes your posts                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  Comments                                        [Toggle ON] â”‚
â”‚  Get notified when someone comments on your posts           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  Mentions                                        [Toggle ON] â”‚
â”‚  Get notified when someone mentions you                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  Event Updates                                   [Toggle ON] â”‚
â”‚  Get notified about RSVPs and event reminders               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  Project Updates                                 [Toggle ON] â”‚
â”‚  Get notified about project activity and milestones         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  Collaboration Invitations                       [Toggle ON] â”‚
â”‚  Get notified when invited to collaborate                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  Priority Alerts âœ“                          [Toggle LOCKED] â”‚
â”‚  Critical updates and security alerts (always enabled)      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  â„¹ï¸  Email Notifications                                     â”‚
â”‚  Email notifications are coming soon. For now, you'll       â”‚
â”‚  receive all notifications in-app.                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ›¡ï¸ Privacy                                                  â”‚
â”‚  Control who can see your information                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â„¹ï¸  Profile Visibility                                      â”‚
â”‚  Your profile is visible to all members of your             â”‚
â”‚  organization. This helps foster collaboration and          â”‚
â”‚  transparency within The Village Hub.                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸšª Sign Out                                                 â”‚
â”‚  Sign out of your account on this device                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Sign Out] (red destructive button)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Hierarchy

```
SettingsPage (Client Component)
â”œâ”€â”€ Container (max-w-4xl)
â”‚   â”œâ”€â”€ Header
â”‚   â”‚   â”œâ”€â”€ Title
â”‚   â”‚   â””â”€â”€ Description
â”‚   â”‚
â”‚   â””â”€â”€ Sections (space-y-6)
â”‚       â”‚
â”‚       â”œâ”€â”€ Account Card
â”‚       â”‚   â”œâ”€â”€ CardHeader
â”‚       â”‚   â”‚   â”œâ”€â”€ User Icon
â”‚       â”‚   â”‚   â”œâ”€â”€ Title
â”‚       â”‚   â”‚   â””â”€â”€ Description
â”‚       â”‚   â””â”€â”€ CardContent
â”‚       â”‚       â”œâ”€â”€ Email Display
â”‚       â”‚       â”œâ”€â”€ Full Name Display
â”‚       â”‚       â”œâ”€â”€ Role Display
â”‚       â”‚       â”œâ”€â”€ Separator
â”‚       â”‚       â””â”€â”€ Edit Profile Button â†’ Link to /profile
â”‚       â”‚
â”‚       â”œâ”€â”€ Change Password Card
â”‚       â”‚   â”œâ”€â”€ CardHeader
â”‚       â”‚   â”‚   â”œâ”€â”€ Lock Icon
â”‚       â”‚   â”‚   â”œâ”€â”€ Title
â”‚       â”‚   â”‚   â””â”€â”€ Description
â”‚       â”‚   â””â”€â”€ CardContent
â”‚       â”‚       â”œâ”€â”€ New Password Input
â”‚       â”‚       â”œâ”€â”€ Confirm Password Input
â”‚       â”‚       â””â”€â”€ Change Password Button
â”‚       â”‚
â”‚       â”œâ”€â”€ Notifications Card
â”‚       â”‚   â”œâ”€â”€ CardHeader
â”‚       â”‚   â”‚   â”œâ”€â”€ Bell Icon
â”‚       â”‚   â”‚   â”œâ”€â”€ Title
â”‚       â”‚   â”‚   â””â”€â”€ Description
â”‚       â”‚   â””â”€â”€ CardContent
â”‚       â”‚       â”œâ”€â”€ Notification Toggles (7 types)
â”‚       â”‚       â”‚   â”œâ”€â”€ Reactions Switch
â”‚       â”‚       â”‚   â”œâ”€â”€ Comments Switch
â”‚       â”‚       â”‚   â”œâ”€â”€ Mentions Switch
â”‚       â”‚       â”‚   â”œâ”€â”€ Event Updates Switch
â”‚       â”‚       â”‚   â”œâ”€â”€ Project Updates Switch
â”‚       â”‚       â”‚   â”œâ”€â”€ Collaboration Switch
â”‚       â”‚       â”‚   â””â”€â”€ Priority Alerts Switch (disabled)
â”‚       â”‚       â”œâ”€â”€ Separator
â”‚       â”‚       â”œâ”€â”€ Email Info Banner
â”‚       â”‚       â””â”€â”€ Saving Indicator (conditional)
â”‚       â”‚
â”‚       â”œâ”€â”€ Privacy Card
â”‚       â”‚   â”œâ”€â”€ CardHeader
â”‚       â”‚   â”‚   â”œâ”€â”€ Shield Icon
â”‚       â”‚   â”‚   â”œâ”€â”€ Title
â”‚       â”‚   â”‚   â””â”€â”€ Description
â”‚       â”‚   â””â”€â”€ CardContent
â”‚       â”‚       â””â”€â”€ Profile Visibility Info Banner
â”‚       â”‚
â”‚       â””â”€â”€ Sign Out Card (border-destructive)
â”‚           â”œâ”€â”€ CardHeader
â”‚           â”‚   â”œâ”€â”€ LogOut Icon
â”‚           â”‚   â”œâ”€â”€ Title (destructive color)
â”‚           â”‚   â””â”€â”€ Description
â”‚           â””â”€â”€ CardContent
â”‚               â””â”€â”€ Sign Out Button (destructive variant)
```

## State Management

```typescript
// Local State
const [userId, setUserId] = useState<string | null>(null)
const [userEmail, setUserEmail] = useState<string | null>(null)
const [userProfile, setUserProfile] = useState<any>(null)
const [loading, setLoading] = useState(true)
const [saving, setSaving] = useState(false)
const [notifications, setNotifications] = useState<NotificationPreferences>({...})
const [newPassword, setNewPassword] = useState("")
const [confirmPassword, setConfirmPassword] = useState("")
const [changingPassword, setChangingPassword] = useState(false)
```

## Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User loads     â”‚
â”‚  /settings      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  useEffect on mount             â”‚
â”‚  1. Get user from Supabase Auth â”‚
â”‚  2. Load user profile           â”‚
â”‚  3. Load notification prefs     â”‚
â”‚  4. Set loading = false         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Render Settings UI             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User toggles notification      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Update local state          â”‚
â”‚     (optimistic update)         â”‚
â”‚  2. Call server action          â”‚
â”‚  3. Show toast notification     â”‚
â”‚  4. Handle errors (revert)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Server Actions Flow

```
Client (Settings Page)
    â”‚
    â”œâ”€â”€â–º getNotificationPreferences(userId)
    â”‚    â””â”€â”€â–º Supabase: SELECT from user_settings
    â”‚         â””â”€â”€â–º Return preferences or defaults
    â”‚
    â”œâ”€â”€â–º updateNotificationPreferences(userId, prefs)
    â”‚    â””â”€â”€â–º Supabase: UPSERT into user_settings
    â”‚         â””â”€â”€â–º Return success/error
    â”‚
    â”œâ”€â”€â–º getUserProfile(userId)
    â”‚    â””â”€â”€â–º Supabase: SELECT from user_profiles
    â”‚         â””â”€â”€â–º Return profile data
    â”‚
    â”œâ”€â”€â–º changePassword(newPassword)
    â”‚    â””â”€â”€â–º Supabase Auth: updateUser({ password })
    â”‚         â””â”€â”€â–º Return success/error
    â”‚
    â””â”€â”€â–º signOut()
         â””â”€â”€â–º Supabase Auth: signOut()
              â””â”€â”€â–º Redirect to /login
```

## Notification Preference Logic

```typescript
// When toggling a preference
handleNotificationToggle(key, value) {
  if (key === 'priority_alerts') {
    // Show error toast - cannot disable
    return
  }

  // Optimistic update
  setNotifications({ ...notifications, [key]: value })

  // Save to database
  updateNotificationPreferences(userId, newPrefs)
    .then(() => {
      // Success toast
      toast({ title: "Preferences Saved" })
    })
    .catch(() => {
      // Error toast + revert
      setNotifications(oldNotifications)
      toast({ title: "Error", variant: "destructive" })
    })
}
```

## Password Change Logic

```typescript
handleChangePassword() {
  // Validation
  if (newPassword.length < 8) {
    toast({ title: "Password Too Short" })
    return
  }

  if (newPassword !== confirmPassword) {
    toast({ title: "Passwords Don't Match" })
    return
  }

  // Update password
  changePassword(newPassword)
    .then(() => {
      toast({ title: "Password Changed" })
      setNewPassword("")
      setConfirmPassword("")
    })
    .catch((error) => {
      toast({ title: "Error", variant: "destructive" })
    })
}
```

## Responsive Breakpoints

```css
/* Mobile First */
- Full-width cards
- Stacked sections
- Full-width buttons

/* sm: 640px */
- Buttons can be auto-width
- More padding

/* md: 768px */
- Cards get more spacing

/* lg: 1024px */
- Max container width (4xl = 896px)
- Optimal reading width
```

## Accessibility Features

- âœ… Semantic HTML (sections, headers, labels)
- âœ… Proper label associations (htmlFor)
- âœ… Focus management on inputs
- âœ… ARIA labels on switches
- âœ… Keyboard navigation
- âœ… Screen reader friendly
- âœ… Color contrast (AA compliant)
- âœ… Error messages
- âœ… Loading states

## Error Handling

```typescript
// All server actions follow this pattern
try {
  const result = await serverAction()
  if (result.error) {
    toast({ title: "Error", description: result.error, variant: "destructive" })
    return
  }
  // Success handling
  toast({ title: "Success", description: "..." })
} catch (error) {
  toast({
    title: "Error",
    description: error.message,
    variant: "destructive"
  })
}
```

## Toast Notification System

```typescript
// Success Toast
toast({
  title: "Preferences Saved",
  description: "Your notification preferences have been updated.",
})

// Error Toast
toast({
  title: "Error",
  description: "Failed to save preferences",
  variant: "destructive",
})

// Info Toast (Priority Alerts)
toast({
  title: "Priority Alerts Required",
  description: "Priority alerts cannot be disabled...",
  variant: "destructive",
})
```
